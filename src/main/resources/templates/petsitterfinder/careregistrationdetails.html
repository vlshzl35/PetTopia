<!DOCTYPE html>
<html layout:decorate="~{layout/default}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <title>ì£¼ì†Œ ê²€ìƒ‰ ë° ì˜ˆì•½ ì •ë³´</title>
    <style>
        .page-body {
            display: flex;
            justify-content: space-between; /* ìì‹ ìš”ì†Œ ê°„ì˜ ì—¬ë°±ì„ ê³ ë¥´ê²Œ ë¶„ë°° */
            flex-wrap: wrap;
            align-items: flex-start;
            width: 80%;
            height: 1500px;
            margin: 10px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .reservation-details {
            width: 45%; /* ë„ˆë¹„ ì„¤ì • */
            background: #d4edda; /* ë°°ê²½ìƒ‰ */
            padding: 20px; /* ë‚´ë¶€ ì—¬ë°± */
            border-radius: 8px; /* í…Œë‘ë¦¬ ë‘¥ê¸€ê²Œ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* ê·¸ë¦¼ì íš¨ê³¼ */
            text-align: center; /* í…ìŠ¤íŠ¸ ì™¼ìª½ ì •ë ¬ */
            line-height: 1.6; /* ì¤„ ê°„ê²© */
        }

        .petProfile {
            width: 40%;
            text-align: center;
        }

        .petProfile img {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .map-spot {
            position: absolute;
            width: 40%;
            text-align: center;
            bottom: 20px;
            right: 20px;
        }

        .map-spot #map {
            width: 100%;
            height: 350px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }


        .comment-section {
            width: 55%; /* ëŒ“ê¸€ ì„¹ì…˜ì˜ ë„ˆë¹„ë¥¼ ë¶€ëª¨ ìš”ì†Œì˜ 45%ë¡œ ì„¤ì •*/
            background: #f8f9fa; /* ë°°ê²½ìƒ‰ */
            padding: 30px; /* ëŒ“ê¸€ ì„¹ì…˜ ì•ˆì˜ ì½˜í…ì¸ ì™€ ê²½ê³„ì„  ì‚¬ì´ì— 20 í”½ì…€ì˜ ì—¬ë°±ì„ ì¶”ê°€í•¨*/
            border-radius: 8px; /* í…Œë‘ë¦¬ ë‘¥ê¸€ê²Œ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* ê·¸ë¦¼ì íš¨ê³¼ */
            margin-top: 10px; /* ëŒ“ê¸€ ì„¹ì…˜ì˜ ìœ„ìª½ 10í”½ì…€ì˜ ì—¬ë°±ì„ ì¶”ê°€í•˜ì—¬ ë‹¤ë¥¸ ìš”ì†Œì™€ì˜ ê°„ê²©ì„ ë‘   */
            height: 800px;
        }

        .comment-section h3 {
            margin-bottom: 20px;
        }

        .comment-section textarea {
            width: 100%;
            height: 80px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ced4da;
            margin-bottom: 10px;
        }

        .comment-section button {
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .comment-section button:hover {
            background-color: #218838;
        }

        .comment-list {
            margin-top: 20px;
        }

        .comment-list div {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

 <div class="page-body" layout:fragment="main">
    <!-- ì˜ˆì•½ ì •ë³´ í‘œì‹œ ì˜ì—­ -->
    <section class="reservation-details">
        <input type="hidden" id="addressInput" th:value="${detail.address}">
        <h2><strong>ğŸ¶ìš°ë¦¬ ê°•ì•„ì§€ë¥¼ ëŒë´ì£¼ì„¸ìš”ğŸ¶</strong></h2>
        <p>ì´ë¦„: <span th:text="${detail.petName}"></span></p>
        <p>ê°•ì•„ì§€ ì„±ê²©: <span th:text="${detail.petSociability}"></span></p>
        <p>ê°•ì•„ì§€ ì¶œìƒì¼: <span th:text="${detail.petBirth}"></span></p>
        <p>ê²¬ì¢…: <span th:text="${detail.petBreed}"></span></p>
        <p>ê°•ì•„ì§€ í¬ê¸°: <span th:text="${detail.petSize}"></span></p>
        <p>ì˜ˆë°• ì ‘ì¢…: <span th:text="${detail.petVaccinationType}"></span></p>
        <p>ê¸°ìƒì¶© ì˜ˆë°© ì ‘ì¢…: <span th:text="${detail.petParasitePrevention}"></span></p>
        <p>ì˜ˆì•½ ì¢…ë£Œìš”ì²­ ë‚ ì§œ: <input type="date" th:value="${detail.startDate}" readonly></p>
        <p>ì˜ˆì•½ ìš”ì²­ ë‚ ì§œ: <input type="date" th:value="${detail.endDate}" readonly></p>
        <p>ì˜ˆì•½ ì„œë¹„ìŠ¤: <span th:text="${detail.requestService}"></span></p>
        <div class="update-box">
            <button class="btnForUpdate" th:if="${isWriter}" th:onclick="|location.href = '@{/petsitterfinder/detailupdate(postId=${detail.postId})}'|">ìˆ˜ì •</button>
        </div>
    </section>

    <!-- í« í”„ë¡œí•„ ì˜ì—­ -->
    <section class="petProfile">
        <h2>â˜ºï¸ìš°ë¦¬ ê°•ì•„ì§€ì—ìš”â˜ºï¸</h2>
        <img src="/images/KakaoTalk_20240527_201110282.jpg" alt="ê°•ì•„ì§€ ì‚¬ì§„">
    </section>

    <!-- ì§€ë„ í‘œì‹œ ì˜ì—­ -->
    <section class="map-spot">
        <h2>ğŸ ì´ ê·¼ì²˜ì— ì‚´ì•„ìš”ğŸ </h2>
        <div id="map"></div>
    </section>

    <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
<!--     ì‘ì„±ìê°€ ì…ë ¥í•œ ê°’ì´ commentContents.value ë¥¼ Scriptë¡œ ë°›ì•„ì¤Œ
         ë¡œê·¸ì¸ í•œ íšŒì›ì˜ ì´ë¦„ê³¼ memberId ê°’ì´ ë„˜ì–´ê°€ë„ë¡ í•¨

-->

    <section class="comment-section">
        <h3>ëŒ“ê¸€ ì‘ì„±</h3>
        <textarea placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." id="commentContents" name="commentContents"></textarea>
        <input type="hidden" name="commentWriter" id="commentWriter" th:value="${memberInfo.name}">
        <input type="hidden" name="memberId" id="memberId" th:value="${memberInfo.id}">
        <button id="comment-write-btn" onclick="commentWrite()">ëŒ“ê¸€ ì‘ì„±</button>

        <div class="comment-list">
            <div>ì‘ì„±ëœ ëŒ“ê¸€ 1</div>
            <div>ì‘ì„±ëœ ëŒ“ê¸€ 2</div>
        </div>
    </section>
     <script>
<!--         ì‘ì„±ëœ ê°’ì„ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë³´ë‚´ì•¼í•¨ ajaxì´ìš©-->
         const commentWrite = () => {
             const contents = document.getElementById("commentContents").value;
             const writer = document.getElementById("commentWriter").value;
             const memberId = document.getElementById("memberId").value;
             const postId = [[${detail.postId}]]
             console.log(contents)
             console.log(writer)
             console.log(memberId)
             console.log(postId)
             $.ajax({
                 // ìš”ì²­ ë°©ì‹: post, ìš”ì²­ì£¼ì†Œ: /comment/save, ìš”ì²­ë°ì´í„°: ì‘ì„±ë‚´ìš©, ì‘ì„±ì, ê²Œì‹œê¸€ ë²ˆí˜¸( ì–´ë–¤ ê²Œì‹œê¸€ì— ëŒ€í•œ ëŒ“ê¸€ì¸ì§€ ì•Œê¸° ìœ„í•¨ì„)

                 type: "post",
                 url: "/comment/save",
                 data: {
                     "commentContents": contents,
                     "commentWriter":writer,
                     "memberId": memberId,
                     "postId": postId

                 },
                 // AJAX ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½œë°± í•¨ìˆ˜ì„.
                 success: function (res){
                     console.log("ìš”ì²­ ì„±ê³µ", res);
                 },
                 error: function (err){
                     console.log("ìš”ì²­ ì‹¤íŒ¨", err);
                 }


             });
         }
     </script>


<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c2c4e06dc64e84c36fa8af04a0f00306&libraries=services"></script>
<script>
    var mapContainer = document.getElementById('map'),
        mapOption = {
            center: new kakao.maps.LatLng(33.450701, 126.570667),
            level: 2
        };

    var map = new kakao.maps.Map(mapContainer, mapOption);
    var geocoder = new kakao.maps.services.Geocoder();
    var marker = new kakao.maps.Marker({ map: map });
    var infowindow = new kakao.maps.InfoWindow();

    function searchAddress() {
        var address = document.getElementById('addressInput').value;

        geocoder.addressSearch(address, function(result, status) {
            if (status === kakao.maps.services.Status.OK) {
                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                marker.setPosition(coords);
                infowindow.setContent('<div style="width:150px;text-align:center;padding:6px 0;">' + address + '</div>');
                infowindow.open(map, marker);
                map.setCenter(coords);
            } else {
                infowindow.close();
                marker.setMap(null);
            }
            var circle = new kakao.maps.Circle({
                center: new kakao.maps.LatLng(result[0].y, result[0].x),
                radius: 30,
                strokeWeight: 5,
                strokeColor: '#75B8FA',
                strokeOpacity: 1,
                strokeStyle: 'dashed',
                fillColor: '#CFE7FF',
                fillOpacity: 0.4
            });
            circle.setMap(map);
        });
    }

    document.addEventListener('DOMContentLoaded', searchAddress);
</script>
 </div>
</body>
</html>
