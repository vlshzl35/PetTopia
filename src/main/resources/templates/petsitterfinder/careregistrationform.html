<!DOCTYPE html>
<html layout:decorate="~{layout/default}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>í«ì‹œí„° ì°¾ê¸° ì˜ˆì•½ í˜ì´ì§€</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7f6;
        }

        .page-body {
            width: 70%;
            margin: 40px auto;
            padding: 40px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            font-weight: bold;
            color: #333333;
        }

        input[type="text"],
        input[type="date"],
        select,
        textarea {
            padding: 12px;
            border: 1px solid #dddddd;
            border-radius: 6px;
            box-sizing: border-box;
            transition: border-color 0.3s ease;
            background-color: #f9f9f9;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus,
        textarea:focus {
            border-color: #7cb342;
            outline: none;
        }

        .submit-btn {
            background-color: #7cb342;
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 18px;
            width: 100%;
        }

        .submit-btn:hover {
            background-color: #689f38;
        }

        .form-container {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .left-column,
        .right-column {
            width: 48%;
            min-width: 300px;
        }

        /* ë™ê·¸ë€ ì´ë¯¸ì§€ */
        .rounded-circle {
            width: 150px;
            height: 150px;
            object-fit: cover;
            margin-top: 20px;
            border-radius: 50%;
            border: 4px solid #e9e9e9;
        }

        /* í—¤ë” ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .hero-wrap {
            height: 300px;
            border-radius: 8px;
            background-size: cover;
            background-position: center center;
        }

        /* ë¼ë””ì˜¤ ë²„íŠ¼ ê·¸ë£¹ ìŠ¤íƒ€ì¼ë§ */
        .radio-group {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ ëª…ì‹œ */
        .navbar {
            background-color: #ffffff !important; /* í°ìƒ‰ ë°°ê²½ */
            padding: 10px 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* í—¤ë” ê·¸ë¦¼ì */
        }

        .navbar .nav-link, .navbar-brand {
            color: #000000 !important; /* ê²€ì •ìƒ‰ í…ìŠ¤íŠ¸ */
            font-weight: bold;
        }

    </style>

</head>
<body>
<div class="page-body" layout:fragment="main">
    <section class="hero-wrap" data-stellar-background-ratio="0.5"
             style="background-image: url('/images/KakaoTalk_20240527_201110282.jpg');"></section>

    <h2 class="text-center my-4">í«ì‹œí„° ì˜ˆì•½ ë“±ë¡</h2>

    <form method="post" name="careRegistration">
        <div class="form-container">
            <div class="left-column">
                <div class="form-group">
                    <label>í« ì„ íƒ:</label>
                    <select id="petSelect" name="petId" class="form-select">
                        <option disabled selected value="">ëŒë³´ì‹¤ í«ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</option>
                        <option th:each="pet : ${pets}" th:text="${pet.name}" th:value="${pet.petId}"
                                data-file="${pet.profile}"></option>
                    </select>
                </div>


                <input type="text" name="profile" id="profile" style="display: none">


                <script>
                    document.getElementById('petSelect').addEventListener('change', function () {
                        var petId = this.value;
                        console.log("ì„ íƒëœ í« ID : ", petId);
                        $.ajax({
                                url: '[[@{/petsitterfinder/request-pet-info}]]',
                                method: 'get',
                                type: 'json',
                                data: {petId: petId},
                                success(data) {
                                    console.log(data)
                                    $('#profileImage').attr('src', data.profile);
                                    $('#petName').val(data.name);
                                    $('#petAge').val(data.age);
                                    // $('#petGender').val(data.petGender);
                                    $('#petBirth').val(data.birth);
                                    $('#petSociability').val(data.socialization);
                                    // $('#petSize').val(data.size);
                                    // $('#petVaccinationType').val(data.vaccinationType);
                                    // $('#petParasitePrevention').val(data.parasitePrevention);
                                    $('#petBreed').val(data.breed);
                                    // $('#isMissing').val(data.status);
                                    // $('#isNeutered').val(data.neutered);
                                    $('#profile').val(data.profile)

                                    // enum íƒ€ì… ì˜ì–´ë¡œ ë°›ì•„ì˜¤ê³  ë·°ë‹¨ì— í•œê¸€ë¡œ ë¿Œë ¤ì£¼ëŠ” ì½”ë“œ
                                    /**
                                     * ë™ë“± (==) ë° ì¼ì¹˜ (===) ì—°ì‚°ì
                                     * ë™ë“±?
                                     * -> ë‘ ê°’ì´ ê°™ìœ¼ë©´ true ë‹¤ë¥´ë©´ false ë°˜í™˜í•¨
                                     * í˜ˆ ë³€í™˜ì„ ìˆ˜í–‰í•˜ì—¬ íƒ€ì…ì´ ë‹¤ë¥¸ ê²½ìš°ì—ë„ ë¹„êµë¥¼ í•¨
                                     * ex) 5 == "5" true
                                     *
                                     * ì¼ì¹˜?
                                     * -> ë‘ ê°’ì´ íƒ€ì…ê³¼ ê°’ì´ ëª¨ë‘ ê°™ì•„ì•¼ 'true' ë‹¤ë¥´ë©´ 'false' ë°˜í™˜
                                     * ex) 5 === "5" false
                                     *
                                     * ê·¸ë˜ì„œ json íƒ€ì…ê³¼ ë¹„êµê°€ ë˜ëŠ” ë“¯
                                     *
                                     */

                                        // parasitePrevention Enumíƒ€ì… í•œê¸€ë¡œ ë·°ì—ì„œ ë³´ì—¬ì£¼ê³  ì„œë²„ì—ëŠ” ì˜ì–´ë¡œ ì €ì¥í•˜ëŠ” ì½”ë“œ
                                    const view0 = [];
                                    const server0 = [];
                                    const parasiteData = data.parasitePrevention;
                                    console.log(parasiteData)

                                    parasiteData.forEach(function (item) {
                                        if (item == "HEARTWORM") {
                                            server0.push("HEARTWORM")
                                            view0.push("ì‹¬ì¥ì‚¬ìƒì¶©")
                                        }
                                        if (item == 'FLEA_TICK') {
                                            server0.push("FLEA_TICK")
                                            view0.push("ë²¼ë£©ê³¼ ì§„ë“œê¸°")
                                        }

                                        $('#petParasitePreventionDisplay').val(view0.join(","))
                                        $('#petParasitePrevention').val(server0.join(","))
                                    })

                                    // í« ì˜ˆë°©ì ‘ì¢… enum -> í•œê¸€ë¡œ

                                    const view = [];
                                    const server = [];
                                    const vaccinationOfData = data.vaccinationType;

                                    vaccinationOfData.forEach(function (item2) {
                                        console.log(item2)
                                        if (item2 == 'RABIES') {
                                            view.push('ê´‘ê²¬ë³‘')
                                            server.push('RABIES')
                                        }

                                        if (item2 == 'COMBINED_VACCINE') {
                                            view.push('ì¢…í•© ë°±ì‹ ')
                                            server.push('COMBINED_VACCINE')
                                        }

                                        if (item2 == 'CORONAVIRUS') {
                                            view.push('ì½”ë¡œë‚˜')
                                            server.push('CORONAVIRUS')
                                        }
                                        if (item2 == 'KENNEL_COUGH') {
                                            view.push('ì¼„ë„¬ë¡œí”„')
                                            server.push('KENNEL_COUGH')
                                        }

                                        $('#petVaccinationTypeToDisplay').val(view.join(","))
                                        $('#petVaccinationType').val(server.join(","))
                                    });

                                    const server1 = []
                                    const view1 = []
                                    const petSizeData = data.size;

                                    console.log(petSizeData)

                                    if (petSizeData == 'LARGE') {
                                        view1.push('ëŒ€í˜•ê²¬')
                                        server1.push('LARGE')
                                    }
                                    if (petSizeData == 'MEDIUM') {
                                        view1.push('ì¤‘í˜•ê²¬')
                                        server1.push('MEDIUM')
                                    }
                                    if (petSizeData == 'SMALL') {
                                        view1.push('ì†Œí˜•ê²¬')
                                        server1.push('SMALL')
                                    }

                                    $('#petSizeToDisplay').val(view1)
                                    $('#petSize').val(server1)

                                    const view2 = []
                                    const server2 = []
                                    const statusData = data.status

                                    if (statusData == "MISSING") {
                                        view2.push('ìš°ë¦¬ì§‘ ê°•ì•„ì§€ê°€ ì‹¤ì¢… ëì–´ìš” ë„ì™€ì£¼ì„¸ìš”ğŸ¥º')
                                        server2.push('MISSING')
                                    }

                                    if (statusData == "WITH_OWNER") {
                                        view2.push('ê°•ì•„ì§€ë‘ ê°™ì´ ì‚´ì•„ìš”ğŸ˜„')
                                        server2.push('WITH_OWNER')
                                    }

                                    $('#isMissingToDisplay').val(view2)
                                    $('#isMissing').val(server2)

                                    const view3 = []
                                    const server3 = []
                                    const petGender = data.petGender

                                    if (petGender == 'M') {
                                        view3.push('ë‚¨ìì•„ì´ğŸŒ')
                                        server3.push('M')
                                    }
                                    if (petGender == 'F') {
                                        view3.push('ì—¬ìì•„ì´ğŸ§šâ€â™€ï¸')
                                        server3.push('F')
                                    }

                                    $('#petGenderToDisplay').val(view3)
                                    $('#petGender').val(server3)

                                    const view4 = []
                                    const server4 = []
                                    const neutered = data.neutered;

                                    if (neutered == true) {
                                        view4.push('ì¤‘ì„±í™” í–ˆì–´ìš”ğŸ¥º')
                                        server4.push('true')
                                    }

                                    if (neutered == false) {
                                        view4.push('ì¤‘ì„±í™” ì•ˆí–ˆì–´ìš”ğŸ˜')
                                        server4.push('false')
                                    }

                                    $('#isNeutered').val(server4)
                                    $('#isNeuteredToDisplay').val(view4)

                                }
                            }
                        )
                    })


                    // const test3 = "ì‹¬ì¥ì‚¬ìƒì¶©, ë²¼ë£©ê³¼ ì§„ë“œê¸°"
                    // const test2 = "ì‹¬ì¥ì‚¬ìƒì¶©"
                    // const test1 = "ë²¼ë£©ê³¼ ì§„ë“œê¸°"
                    // const test = data.parasitePrevention;
                    // console.log(test)
                    // if (test == 'HEARTWORM') {
                    //     $('#petParasitePreventionDisplay').val(test2)
                    //     $('#petParasitePrevention').val(test)
                    // } else if (test == 'FLEA_TICK') {
                    //     $('#petParasitePreventionDisplay').val(test1)
                    //     $('#petParasitePrevention').val(test)
                    // } else if (test == 'HEARTWORM', 'FLEA_TICK') {
                    //     $('#petParasitePreventionDisplay').val(test3)
                    //     $('#petParasitePrevention').val(test)
                    // }


                </script>
                <div class="form-group text-center">
                    <img id="profileImage" alt="profileImage" name="profileImage" src="" class="rounded-circle"
                         onerror="this.onerror=null;this.src='/images/sample/cutyBoy.png';">
                </div>

                <div class="form-group">
                    <label for="petName">ì´ë¦„:</label>
                    <input id="petName" name="petName" type="text" class="form-control" readonly>
                </div>

                <div class="form-group">
                    <label for="petGender">ì„±ë³„:</label>
                    <input id="petGenderToDisplay" name="petGenderToDisplay" type="text" class="form-control" readonly>
                    <input id="petGender" name="petGender" type="hidden" class="form-control">
                </div>

                <div class="form-group">
                    <label for="petBreed">ê²¬ì¢…:</label>
                    <input id="petBreed" name="petBreed" type="text" class="form-control" readonly>
                </div>

                <div class="form-group">
                    <label for="petBirth">ì¶œìƒì¼:</label>
                    <input id="petBirth" name="petBirth" type="text" class="form-control" readonly>
                </div>

                <div class="form-group">
                    <label for="petSize">ì‚¬ì´ì¦ˆ:</label>
                    <input id="petSizeToDisplay" name="petSizeToDisplay" type="text" class="form-control" readonly>
                    <input id="petSize" name="petSize" type="hidden" class="form-control">
                </div>

                <div class="form-group">
                    <label for="petSociability">ì‚¬íšŒì„±:</label>
                    <input id="petSociability" name="petSociability" type="text" class="form-control" readonly>
                </div>

                <div class="form-group">
                    <label for="petVaccinationType">ì˜ˆë°©ì ‘ì¢…:</label>
                    <input id="petVaccinationTypeToDisplay" name="petVaccinationTypeToDisplay" type="text"
                           class="form-control" readonly>
                    <input id="petVaccinationType" name="petVaccinationType" type="hidden" class="form-control">
                </div>

                <div class="form-group">
                    <label for="petParasitePreventionDisplay">ê¸°ìƒì¶© ì˜ˆë°©:</label>
                    <input id="petParasitePreventionDisplay" name="petParasitePreventionDisplay" type="text"
                           class="form-control" readonly>
                    <!--                    <label for="petParasitePrevention" type="hidden">ê¸°ìƒì¶© ì˜ˆë°©:</label>-->
                    <input id="petParasitePrevention" name="petParasitePrevention" class="form-control" type="hidden">

                </div>

                <div class="form-group">
                    <label for="isNeutered">ì¤‘ì„±í™” ì—¬ë¶€:</label>
                    <input id="isNeuteredToDisplay" name="isNeuteredToDisplay" type="text" class="form-control" readonly>
                    <input id="isNeutered" name="isNeutered" type="hidden" class="form-control">
                </div>

            </div>

            <div class="right-column">
                <div class="form-group">
                    <label for="startDate">ì‹œì‘ ë‚ ì§œ:</label>
                    <input id="startDate" name="startDate" type="date" class="form-control">
                </div>

                <div class="form-group">
                    <label for="endDate">ì¢…ë£Œ ë‚ ì§œ:</label>
                    <input id="endDate" name="endDate" type="date" class="form-control">
                </div>

                <div class="form-group">
                    <label>ì£¼ì†Œ ì…ë ¥(*ë„ë¡œëª… ì£¼ì†Œë§Œ ì…ë ¥í•´ì£¼ì„¸ìš” (ìƒì„¸ ì£¼ì†Œ ì œì™¸) *): </label>
<!--                    <input id="address" name="address" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" type="text" class="form-control">-->
                    <input type="text" id="sample6_postcode" placeholder="ìš°í¸ë²ˆí˜¸" class="form-control">
                    <input type="button" onclick="sample6_execDaumPostcode()" value="ìš°í¸ë²ˆí˜¸ ì°¾ê¸°" class="form-control"><br>
                    <input type="text" id="sample6_address" name="address" placeholder="ì£¼ì†Œ" class="form-control" readonly><br>
                    <input type="hidden" id="sample6_extraAddress" name="address" placeholder="ì°¸ê³ í•­ëª©" class="form-control" readonly>
                    <input type="hidden" id="sample6_detailAddress" name="address" placeholder="ìƒì„¸ì£¼ì†Œ" class="form-control" >

                    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
                    <script>
                        function sample6_execDaumPostcode() {
                            new daum.Postcode({
                                oncomplete: function(data) {
                                    // íŒì—…ì—ì„œ ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì„ í´ë¦­í–ˆì„ë•Œ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë¶€ë¶„.

                                    // ê° ì£¼ì†Œì˜ ë…¸ì¶œ ê·œì¹™ì— ë”°ë¼ ì£¼ì†Œë¥¼ ì¡°í•©í•œë‹¤.
                                    // ë‚´ë ¤ì˜¤ëŠ” ë³€ìˆ˜ê°€ ê°’ì´ ì—†ëŠ” ê²½ìš°ì—” ê³µë°±('')ê°’ì„ ê°€ì§€ë¯€ë¡œ, ì´ë¥¼ ì°¸ê³ í•˜ì—¬ ë¶„ê¸° í•œë‹¤.
                                    var addr = ''; // ì£¼ì†Œ ë³€ìˆ˜
                                    var extraAddr = ''; // ì°¸ê³ í•­ëª© ë³€ìˆ˜

                                    //ì‚¬ìš©ìê°€ ì„ íƒí•œ ì£¼ì†Œ íƒ€ì…ì— ë”°ë¼ í•´ë‹¹ ì£¼ì†Œ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
                                    if (data.userSelectedType === 'R') { // ì‚¬ìš©ìê°€ ë„ë¡œëª… ì£¼ì†Œë¥¼ ì„ íƒí–ˆì„ ê²½ìš°
                                        addr = data.roadAddress;
                                    } else { // ì‚¬ìš©ìê°€ ì§€ë²ˆ ì£¼ì†Œë¥¼ ì„ íƒí–ˆì„ ê²½ìš°(J)
                                        addr = data.jibunAddress;
                                    }

                                    // ì‚¬ìš©ìê°€ ì„ íƒí•œ ì£¼ì†Œê°€ ë„ë¡œëª… íƒ€ì…ì¼ë•Œ ì°¸ê³ í•­ëª©ì„ ì¡°í•©í•œë‹¤.
                                    if(data.userSelectedType === 'R'){
                                        // ë²•ì •ë™ëª…ì´ ìˆì„ ê²½ìš° ì¶”ê°€í•œë‹¤. (ë²•ì •ë¦¬ëŠ” ì œì™¸)
                                        // ë²•ì •ë™ì˜ ê²½ìš° ë§ˆì§€ë§‰ ë¬¸ìê°€ "ë™/ë¡œ/ê°€"ë¡œ ëë‚œë‹¤.
                                        if(data.bname !== '' && /[ë™|ë¡œ|ê°€]$/g.test(data.bname)){
                                            extraAddr += data.bname;
                                        }
                                        // ê±´ë¬¼ëª…ì´ ìˆê³ , ê³µë™ì£¼íƒì¼ ê²½ìš° ì¶”ê°€í•œë‹¤.
                                        if(data.buildingName !== '' && data.apartment === 'Y'){
                                            extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                                        }
                                        // í‘œì‹œí•  ì°¸ê³ í•­ëª©ì´ ìˆì„ ê²½ìš°, ê´„í˜¸ê¹Œì§€ ì¶”ê°€í•œ ìµœì¢… ë¬¸ìì—´ì„ ë§Œë“ ë‹¤.
                                        if(extraAddr !== ''){
                                            extraAddr = ' (' + extraAddr + ')';
                                        }
                                        // ì¡°í•©ëœ ì°¸ê³ í•­ëª©ì„ í•´ë‹¹ í•„ë“œì— ë„£ëŠ”ë‹¤.
                                        document.getElementById("sample6_extraAddress").value = extraAddr;

                                    } else {
                                        document.getElementById("sample6_extraAddress").value = '';
                                    }

                                    // ìš°í¸ë²ˆí˜¸ì™€ ì£¼ì†Œ ì •ë³´ë¥¼ í•´ë‹¹ í•„ë“œì— ë„£ëŠ”ë‹¤.
                                    document.getElementById('sample6_postcode').value = data.zonecode;
                                    document.getElementById("sample6_address").value = addr;
                                    // ì»¤ì„œë¥¼ ìƒì„¸ì£¼ì†Œ í•„ë“œë¡œ ì´ë™í•œë‹¤.
                                    document.getElementById("sample6_detailAddress").focus();
                                }
                            }).open();
                        }
                    </script>
                </div>

                <div class="form-group">
                    <label>ëŒë´„ìœ í˜•:</label>
                    <div class="radio-group">
                        <div class="form-check">
                            <input id="visitCare" name="requestService" class="form-check-input"
                                   onclick="toggleRadio(this)" type="checkbox"
                                   value="ë°©ë¬¸ëŒë´„">
                            <label class="form-check-label" for="visitCare">ë°©ë¬¸ëŒë´„</label>
                        </div>
                        <div class="form-check">
                            <input id="walkCare" name="requestService" class="form-check-input"
                                   onclick="toggleRadio(this)" type="checkbox"
                                   value="ì‚°ì±…ëŒë´„">
                            <label class="form-check-label" for="walkCare">ì‚°ì±…</label>
                        </div>
                        <div class="form-check">
                            <input id="leavingCare" name="requestService" class="form-check-input"
                                   onclick="toggleRadio(this)" type="checkbox"
                                   value="ë§¡ê¹€ëŒë´„">
                            <label class="form-check-label" for="leavingCare">ë§¡ê¹€ëŒë´„</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                            <textarea id="additionalInfo" name="additionalInfo" class="form-control"
                                      placeholder="ì¶”ê°€ì ì¸ ì‚¬í•­ì´ ìˆë‹¤ë©´ ê¸°ì¬í•´ì£¼ì„¸ìš” ex) ì‚°ì±… ê²½ë¡œ, ì¶”ê°€ì ì¸ ë¬¸ì˜ ì‚¬í•­ì€ ëŒ“ê¸€ì— ë‚¨ê²¨ì£¼ì„¸ìš” ë“±ë“±"
                                      cols="50" rows="10"
                            ></textarea>
                </div>
            </div>
            <button class="submit-btn" type="submit">ì˜ˆì•½ ë“±ë¡í•˜ê¸°</button>
        </div>
    </form>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
