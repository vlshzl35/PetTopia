<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <title>íšŒì›ê°€ì…</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        .modal-body {
            max-height: 400px;
            overflow-y: auto;
        }

        .btn-container {
            display: flex;
            justify-content: space-between;
        }

        .btn-full {
            width: 100%;
        }

        .form-row {
            margin-bottom: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group .form-control {
            display: inline-block;
        }

        .form-group .form-control.btn {
            width: 100px;
        }

        /* Make the submit button full width */
        .btn-primary {
            width: 100%;
            display: block;
        }
    </style>
</head>
<body>
<div layout:fragment="main" class="page-body">

    <section class="ftco-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-6 text-center mb-5">
                    <h2 class="heading-section">íšŒì›ê°€ì…</h2>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-md-12">
                    <div class="wrapper">
                        <form id="signup-form" method="post" onsubmit="return isValid()">
                            <!-- íšŒì›ê°€ì… í¼ -->
                            <h3>íšŒì›ê°€ì…</h3>
                            <div class="form-group">
                                <label for="profile-pic">í”„ë¡œí•„ ì‚¬ì§„</label>
                                <input type="file" class="form-control-file" id="profile-pic" name="profileImage">
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="email">ì´ë©”ì¼ *</label>
                                    <div style="display: flex">
                                        <input type="email" class="form-control" id="email" placeholder="ì´ë©”ì¼ ì…ë ¥"
                                               name="email" style="margin-right: 10px" required>
                                        <input type="button" class="btn btn-primary" id="emailCheck"
                                               onclick="duplicateEmailCheck()" value="ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬">
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="password">ë¹„ë°€ë²ˆí˜¸ *</label>
                                    <input type="password" class="form-control" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
                                           name="password" required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="confirm-password">ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *</label>
                                    <input type="password" class="form-control" id="confirm-password"
                                           placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" onKeyUp=pwCheck()  name="passwordCheck" required>
                                    <p id="pwResult"></p>
                                </div>

                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="name">ì´ë¦„ *</label>
                                    <input type="text" class="form-control" id="name" placeholder="ì´ë¦„ ì…ë ¥" name="name"
                                           required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="nickname">ë‹‰ë„¤ì„ *</label>
                                    <input type="text" class="form-control" id="nickname" placeholder="ë‹‰ë„¤ì„ ì…ë ¥"
                                           name="nickName" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="phone">í•¸ë“œí° ë²ˆí˜¸ *</label>
                                    <input type="text" class="form-control" id="phone" placeholder="í•¸ë“œí° ë²ˆí˜¸ ì…ë ¥"
                                           name="phone" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="gender">ì„±ë³„ *</label>
                                    <select class="form-control" id="gender" name="gender" required>
                                        <option value="">ì„±ë³„ ì„ íƒ</option>
                                        <option value="M">ë‚¨ì„±</option>
                                        <option value="F">ì—¬ì„±</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="dob">ìƒë…„ì›”ì¼ *</label>
                                    <input type="date" class="form-control" id="dob" name="birth">
                                </div>
                            </div>

                            <div class="form-row" style="margin-bottom: 10px">
                                <div class="form-group col-md-12" style="margin-bottom: 5px">
                                    <label for="gender">ì£¼ì†Œ *</label>
                                    <div style="display: flex; margin-bottom: 5px">
                                        <input type="text" class="form-control" id="sample6_postcode"
                                               placeholder="ìš°í¸ë²ˆí˜¸">
                                        <input type="button" class="form-control" onclick="sample6_execDaumPostcode()"
                                               value="ìš°í¸ë²ˆí˜¸ ì°¾ê¸°">
                                    </div>
                                    <input type="text" class="form-control col-md-12" id="sample6_address"
                                           placeholder="ì£¼ì†Œ">
                                </div>

                                <div style="display: flex" class="col-md-12">
                                    <input type="text" class="form-control" id="sample6_detailAddress"
                                           placeholder="ìƒì„¸ì£¼ì†Œ">
                                    <input type="text" class="form-control" id="sample6_extraAddress"
                                           placeholder="ì°¸ê³ í•­ëª©">
                                </div>
                            </div>

                            <div>
                                <button type="submit" class="btn btn-primary">íšŒì›ê°€ì…</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- loader -->
    <div id="ftco-loader" class="show fullscreen">
        <svg class="circular" width="48px" height="48px">
            <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/>
            <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                    stroke="#F96D00"/>
        </svg>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script
        src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
        crossorigin="anonymous"></script>

<script layout:fragment="js">
    let emailCheckResult = false;
    let pwCheckResult = false;

    function isValid() {

        if (emailCheckResult) {
            if (emailCheckResult) {
                alert('ğŸ‘íšŒì›ê°€ì…ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤!ğŸ‘');
                return true;
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return false;
            }
        } else {
            alert('ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ë¥¼ ë¨¼ì € í•´ì£¼ì„¸ìš”');
            return false;
        }
    }

    // ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ë¥¼ í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.
    function duplicateEmailCheck() {
        const memberEmail = document.getElementById('email');
        if (!memberEmail) {
            alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return false;
        }

        $.ajax({
            url: '[[@{/member/sameEmailCheck}]]', // ëŒ€ê´„í˜¸ë¥¼ ê¼­ ì¨ì¤˜ì•¼ í•œë‹¤, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ controllerë¡œ ë„˜ì–´ê°€ì§€ ì•ŠëŠ”ë‹¤.
            method: 'post',
            data: {
                memberEmail: memberEmail.value
            },
            success: function (res) {

                if (res === true) {
                    alert('ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                    console.log('ì‚¬ìš©ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”');
                    emailCheckResult = false; // ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ ì‹¤íŒ¨
                }
                else {
                    alert('ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼ì…ë‹ˆë‹¤!');
                    emailCheckResult = true; // ì´ë©”ì¼ ì‚¬ìš© ê°€ëŠ¥
                }
            },
            error: function () {
                console.log('ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ ì˜¤ë¥˜ì…ë‹ˆë‹¤.');
            },
            complete: function () {
                console.log('ì´ë©”ì¼ ì¤‘ë³µ ì²´í¬ ì™„ë£Œ')
            }
        });
        return emailCheckResult;
    }

    // ë¹„ë°€ë²ˆí˜¸ í™•ì¸í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.
    const pwCheck = () => {
        const pw = document.getElementById('password').value;
        const pwCheck = document.getElementById('confirm-password').value;
        const pwResult = document.getElementById('pwResult');

        if(pw === pwCheck) {
            pwResult.style.color = '#00bd56';
            pwResult.innerHTML = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
            pwCheckResult = true;
        }else {
            pwResult.style.color = '#e2263e';
            pwResult.innerHTML = " ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
            pwCheckResult = false;
        }
    }

    function sample6_execDaumPostcode() {
        new daum.Postcode({
            oncomplete: function (data) {
                let addr = '';
                let extraAddr = '';

                if (data.userSelectedType === 'R') {
                    addr = data.roadAddress;
                } else {
                    addr = data.jibunAddress;
                }

                if (data.userSelectedType === 'R') {
                    if (data.bname !== '' && /[ë™|ë¡œ|ê°€]$/g.test(data.bname)) {
                        extraAddr += data.bname;
                    }
                    if (data.buildingName !== '' && data.apartment === 'Y') {
                        extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }
                    if (extraAddr !== '') {
                        extraAddr = ' (' + extraAddr + ')';
                    }
                    document.getElementById("sample6_extraAddress").value = extraAddr;
                } else {
                    document.getElementById("sample6_extraAddress").value = '';
                }

                document.getElementById('sample6_postcode').value = data.zonecode;
                document.getElementById("sample6_address").value = addr;
                document.getElementById("sample6_detailAddress").focus();
            }
        }).open();
    }
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</body>
</html>
